# MongoDB Database with FastAPI in Docker Compose

This project demonstrates how to set up a MongoDB database using FastAPI within a Docker container. It focuses on implementing CRUD operations for managing software vulnerabilities and can be deployed using Docker Compose. This serves as a practical example of deploying microservices with CRUD functionality for managing software vulnerabilities.

## Prerequisites

Before you begin, ensure you have installed the following tools:

- Install Python: Ensure you have Python installed on your system. You can download it from the official website.
- Install Pip: Make sure you have `pip` installed to manage Python packages.
- Install FastAPI: Run `pip install fastapi` to install FastAPI.
- Install Uvicorn: Run `pip install uvicorn` to install Uvicorn, an ASGI server.
- Install PyMongo: Run `pip install pymongo[srv]` to install PyMongo with support for MongoDB servers.
- Install Docker: Follow the official Docker installation guide for your operating system.

## Local Testing

To test the application locally:

1. Create a virtual environment: `python -m venv env`
2. Activate the virtual environment:
   - On Windows: `.\env\Scripts\Activate.ps1`
   - On macOS/Linux: `source env/bin/activate`
3. Set execution policy bypass (Windows only): `Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass`
4. Start the FastAPI application: `uvicorn main:app --reload`

The application will now be running at `http://127.0.0.1:8000/docs`.

## Docker Deployment

To deploy the application using Docker:

1. Build the Docker image: `docker build -f Dockerfile. -t dockerpy`
2. Start the containers using Docker Compose: `docker compose up`

The application will now be running at `http://127.0.0.1:8000/docs`.

## API Endpoints

The FastAPI application provides the following endpoints to manage vulnerabilities:

- **Create a vulnerability**
![Post](/assets/post.png)
  - `POST: "/"`
  - Request body: JSON object with the vulnerability details.
  ```json
    {
    "name": "string",
    "priority": 0,
    "danger": "string"
    }

- **Read all vulnerabilities**
![Get](/assets/get.png)
  - `GET: "/"`
  - Response: JSON array of all vulnerabilities.

- **Update a vulnerability**
![Put](/assets/put.png)
  - `PUT: "/{id}"`
  - Path parameter: `id` of the vulnerability.
  - Request body: JSON object with the updated details.
    ```json
    id: "XXXXXXXXXXXXXXX"

    {
    "name": "string",
    "priority": 0,
    "danger": "string"
    }

- **Delete a vulnerability**
![Delete](/assets/delete.png)
  - `DELETE "/{id}"`
  - Path parameter: `id` of the vulnerability.

## Project Structure

- `main.py`: This is the entry point of the FastAPI application. It initializes the FastAPI instance and includes the router defined in `routes/route.py`.

- `config/database.py`: This file handles database configurations. It establishes a connection to MongoDB using pymongo and defines the database and collection objects used throughout the application.

- `models/vulnerabilities.py`: This module defines the data model for vulnerabilities using Pydantic's BaseModel. It specifies the structure of a vulnerability including its name, priority, and danger level.

- `routes/route.py`: API routes for handling vulnerability-related operations are defined here. This module contains endpoints for retrieving, creating, updating, and deleting vulnerabilities. It utilizes the FastAPI APIRouter to organize these endpoints efficiently.

- `schema/schemas.py`: This module provides functions for serializing and deserializing vulnerability data. It includes functions for converting MongoDB documents to Python dictionaries and lists of dictionaries, making them suitable for use in FastAPI responses.

- `Dockerfile`: Contains instructions for building a Docker image for the FastAPI application. It specifies the base image, sets up the environment, and copies the application code into the image, facilitating deployment and reproducibility.

- `docker-compose.yml`: This Docker Compose file defines services for running both the FastAPI application and MongoDB database. It specifies configurations for each service, including environment variables, volumes, and ports, enabling easy setup and deployment of the entire application stack.


## Usage

1. Launch the application by following either the local testing steps or the Docker deployment steps outlined above.
2. Open your preferred web browser and navigate to `http://127.0.0.1:8000/docs`.

## Notes

- Ensure Docker is running on your machine before deploying with Docker Compose.
- The MongoDB connection string and other configurations can be managed through environment variables or configuration files as needed.

## Acknowledgements

- [FastAPI](https://fastapi.tiangolo.com/)
- [MongoDB](https://www.mongodb.com/)
- [Docker](https://www.docker.com/)

## Contact

If you have any questions or suggestions, feel free to contact me at [moypineda10@gmail.com](mailto:moypineda10@gmail.com).

